let buttonLogin=document.getElementById("login__btn"),modalWindow=document.querySelector(".modal__window"),modalWrap=document.querySelector(".modal__wrap"),buttonClose=document.getElementById("close_btn");buttonLogin.addEventListener("click",()=>{modalWindow.classList.toggle("modal__window--active")}),buttonClose.addEventListener("click",()=>{modalWindow.classList.toggle("modal__window--active")}),window.addEventListener("click",e=>{e.target==modalWindow&&e.target!=modalWrap&&modalWindow.classList.toggle("modal__window--active")});const INPUT_LOGIN_ERROR="Введите действительный электронный адрес",INPUT_PASSWORD_ERROR="Введите пароль";let inputLogin=document.getElementById("modal-input-login"),inputPassword=document.getElementById("modal-input-password"),modalSubmitBtn=document.getElementById("modal-submit-button"),loginError=document.getElementById("input-error-login"),passwordError=document.getElementById("input-error-password");function validateLogin(e){return/\S+@\S+\.\S+/.test(e)}function validatePassword(e){return/(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])[0-9a-zA-Z]{6,}/.test(e)}function enableError(e,t,a){t.innerHTML=a,e.classList.add("input-highlight"),modalSubmitBtn.classList.add("submit-disabled"),modalSubmitBtn.disabled=!0}function disableError(e,t){t.innerHTML="",e.classList.remove("input-highlight"),modalSubmitBtn.classList.remove("submit-disabled"),modalSubmitBtn.disabled=!1}inputLogin.addEventListener("blur",()=>{validateLogin(inputLogin.value)&&inputLogin.value.length>0?disableError(inputLogin,loginError):enableError(inputLogin,loginError,INPUT_LOGIN_ERROR)}),inputPassword.addEventListener("blur",()=>{validatePassword(inputPassword.value)&&inputPassword.value.length>0?disableError(inputPassword,passwordError):enableError(inputPassword,passwordError,"Введите пароль")});const NULL_TEXT_ERROR="Введите текст новости",IMAGE_FORMAT_ERROR="Неверный формат изображения",TEXTAREA_LIMIT_ERROR="Превышен лимит символов";let textareaInput=document.querySelector(".add__textarea"),textareaInfo=document.querySelector(".add__form-textarea-info"),errorBlock=document.querySelector(".form__add__error"),submitButton=document.querySelector(".form__add-btn"),addImgBtn=document.querySelector(".form__add-img");function checkTextareaLenght(){0!=textareaInput.value.length?(textareaInfo.classList.add("add__form-textarea-info--active"),addImgBtn.style="margin-top: 6px;"):(textareaInfo.classList.remove("add__form-textarea-info--active"),addImgBtn.style="margin-top: 21px;")}textareaInput.onkeyup=()=>{checkTextareaLenght(),textareaInfo.innerHTML=`Символов: ${textareaInput.value.length}/150`,textareaInput.value.length>150?(textareaInfo.innerHTML=`Символов: <span class="highlight">${textareaInput.value.length}</span>/150`,errorBlock.innerHTML=TEXTAREA_LIMIT_ERROR):dropError()};let uploadInput=document.getElementById("upload_image_input"),dropImage=document.querySelector(".form__add__uploaded-img_close-btn"),addForm=document.querySelector(".add__form"),uploadedImage={container:document.querySelector(".form__add__uploaded-img__container"),icon:document.querySelector(".form__add__uploaded-img-icon"),name:document.querySelector(".form__add__uploaded-img-name")},fileReader=new FileReader,image=new Image,imageData={url:null,fileName:null};uploadInput.addEventListener("change",()=>{let e=uploadInput.files[0];e.type&&-1!=e.type.search("image/+(jpeg|png)")?(fileReader.readAsDataURL(e),imageData.fileName=e.name,dropError(),e.name.length>20&&(imageData.fileName=imageData.filename.slice(0,20)+"..."+e.type.match("jpeg|png"))):errorBlock.innerHTML=IMAGE_FORMAT_ERROR}),fileReader.addEventListener("load",e=>{let t=e.target.result;image.src=t,imageData.url=t});let displayUploadedImage=()=>{uploadedImage.container.classList.toggle("form__add__uploaded-img__container--active"),uploadedImage.icon.src=imageData.url,uploadedImage.name.innerHTML=imageData.fileName};function removeImage(){uploadInput.value=null,imageData.fileName=null,imageData.url=null}function dropError(){errorBlock.innerHTML=""}image.addEventListener("load",(function(){let e=this.width,t=this.height;e&&t&&e<=270&&t<=270?(displayUploadedImage(),dropError()):(errorBlock.innerHTML=IMAGE_FORMAT_ERROR,removeImage())})),dropImage.addEventListener("click",e=>{e.preventDefault(),uploadedImage.container.classList.toggle("form__add__uploaded-img__container--active"),removeImage()}),submitButton.addEventListener("click",e=>{0===textareaInput.value.length?errorBlock.innerHTML=NULL_TEXT_ERROR:(dropError(),addForm.submit())});